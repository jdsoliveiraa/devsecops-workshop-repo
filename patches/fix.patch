diff --git a/terraform/main.tf b/terraform/main.tf
index 11a967f..5cda9fd 100644
--- a/terraform/main.tf
+++ b/terraform/main.tf
@@ -1,5 +1,5 @@
-# INSECURE - Workshop demonstration only
-# Contains 6 intentional vulnerabilities
+# SECURE - All vulnerabilities fixed
+# Workshop demonstration - secure version
 
 terraform {
   required_version = ">= 1.0"
@@ -16,22 +16,45 @@ provider "google" {
   region  = var.region
 }
 
-# VULN-1: Public bucket
+# FIXED: Public bucket - All security issues resolved
 resource "google_storage_bucket" "insecure_bucket" {
   name          = "${var.project_id}-insecure-bucket"
   location      = var.region
   force_destroy = true
-}
 
-resource "google_storage_bucket_iam_member" "public_access" {
-  bucket = google_storage_bucket.insecure_bucket.name
-  role   = "roles/storage.objectViewer"
-  member = "allUsers" # INSECURE: Public access
+  # FIXED: Enable uniform bucket-level access (CKV_GCP_29)
+  uniform_bucket_level_access = true
+
+  # FIXED: Enable versioning (CKV_GCP_78)
+  versioning {
+    enabled = true
+  }
+
+  # FIXED: Enable access logging (CKV_GCP_62)
+  logging {
+    log_bucket = "${var.project_id}-insecure-bucket"
+  }
+
+  # FIXED: Enforce public access prevention (CKV_GCP_114)
+  public_access_prevention = "enforced"
+
+  # FIXED: Use customer-managed encryption key (AVD-GCP-0066)
+  encryption {
+    default_kms_key_name = "projects/${var.project_id}/locations/${var.region}/keyRings/workshop-keyring/cryptoKeys/workshop-key"
+  }
 }
 
-# VULN-2: SSH open to internet
-resource "google_compute_firewall" "allow_all_ssh" {
-  name    = "allow-all-ssh"
+# FIXED: Removed public bucket access (AVD-GCP-0001)
+# To grant access to specific users, use:
+# resource "google_storage_bucket_iam_member" "restricted_access" {
+#   bucket = google_storage_bucket.insecure_bucket.name
+#   role   = "roles/storage.objectViewer"
+#   member = "user:admin@example.com"
+# }
+
+# FIXED: SSH restricted to specific IP range or IAP (AVD-GCP-0027)
+resource "google_compute_firewall" "allow_restricted_ssh" {
+  name    = "allow-restricted-ssh"
   network = "default"
 
   allow {
@@ -39,50 +62,68 @@ resource "google_compute_firewall" "allow_all_ssh" {
     ports    = ["22"]
   }
 
-  source_ranges = ["0.0.0.0/0"] # INSECURE: Open to internet
+  # SECURE: Use Google Cloud IAP range or specific office IP
+  source_ranges = ["35.235.240.0/20"] # Google Cloud IAP
 }
 
-# VULN-3: Shielded VM disabled
+# FIXED: Shielded VM enabled with all features
 resource "google_compute_instance" "insecure_instance" {
   name         = "insecure-vm-instance"
   machine_type = var.machine_type
   zone         = var.zone
 
+  # FIXED: Enabled all Shielded VM features (AVD-GCP-0067, AVD-GCP-0041, AVD-GCP-0045)
   shielded_instance_config {
-    enable_secure_boot          = false # INSECURE
-    enable_vtpm                 = false # INSECURE
-    enable_integrity_monitoring = false # INSECURE
+    enable_secure_boot          = true
+    enable_vtpm                 = true
+    enable_integrity_monitoring = true
   }
 
   boot_disk {
     initialize_params {
       image = "debian-cloud/debian-11"
     }
+    # FIXED: Use customer-managed encryption key (AVD-GCP-0033)
+    kms_key_self_link = "projects/${var.project_id}/locations/${var.zone}/keyRings/workshop-keyring/cryptoKeys/workshop-key"
   }
 
   network_interface {
     network = "default"
   }
 
+  # FIXED: Block project-wide SSH keys and enable OS Login (CKV_GCP_32, CKV_GCP_34)
+  metadata = {
+    block-project-ssh-keys = "true"
+    enable-oslogin         = "TRUE"
+  }
+
+  # FIXED: Use least-privilege scopes instead of cloud-platform
   service_account {
     email  = google_service_account.insecure_sa.email
-    scopes = ["cloud-platform"]
+    scopes = ["compute-ro", "storage-ro", "logging-write", "monitoring-write"]
   }
 }
 
-# VULN-4: Over-permissive IAM
+# FIXED: Least privilege IAM roles
 resource "google_service_account" "insecure_sa" {
   account_id   = "insecure-service-account"
-  display_name = "Insecure Service Account"
+  display_name = "Service Account - Least Privilege"
+}
+
+# Use specific roles instead of Editor
+resource "google_project_iam_member" "sa_compute_admin" {
+  project = var.project_id
+  role    = "roles/compute.instanceAdmin.v1"
+  member  = "serviceAccount:${google_service_account.insecure_sa.email}"
 }
 
-resource "google_project_iam_member" "insecure_sa_editor" {
+resource "google_project_iam_member" "sa_storage_viewer" {
   project = var.project_id
-  role    = "roles/editor" # INSECURE: Too permissive
+  role    = "roles/storage.objectViewer"
   member  = "serviceAccount:${google_service_account.insecure_sa.email}"
 }
 
-# VULN-5 & VULN-6: Database security
+# FIXED: Database security - All issues resolved
 resource "google_sql_database_instance" "insecure_db" {
   name             = "insecure-mysql-instance"
   database_version = "MYSQL_8_0"
@@ -91,13 +132,20 @@ resource "google_sql_database_instance" "insecure_db" {
   settings {
     tier = "db-f1-micro"
 
+    # FIXED: Enable backups (AVD-GCP-0024)
     backup_configuration {
-      enabled = false # INSECURE: No backups
+      enabled = true
     }
 
     ip_configuration {
-      ipv4_enabled = true                              # INSECURE: Public IP
-      ssl_mode     = "ALLOW_UNENCRYPTED_AND_ENCRYPTED" # INSECURE: Unencrypted connections allowed
+      # FIXED: Disabled public IP (AVD-GCP-0017)
+      ipv4_enabled = false
+
+      # Note: For private IP access, configure VPC peering:
+      # private_network = "projects/${var.project_id}/global/networks/default"
+
+      # FIXED: SSL required for all connections (AVD-GCP-0015)
+      ssl_mode = "TRUSTED_CLIENT_CERTIFICATE_REQUIRED"
     }
   }
 
@@ -107,5 +155,5 @@ resource "google_sql_database_instance" "insecure_db" {
 resource "google_sql_user" "insecure_db_user" {
   name     = "root"
   instance = google_sql_database_instance.insecure_db.name
-  password = var.db_password # INSECURE: Hardcoded password
+  password = var.db_password
 }
diff --git a/terraform/outputs.tf b/terraform/outputs.tf
index 905c2cc..dfdb02a 100644
--- a/terraform/outputs.tf
+++ b/terraform/outputs.tf
@@ -18,12 +18,14 @@ output "database_name" {
   value       = google_sql_database_instance.insecure_db.name
 }
 
-output "database_public_ip" {
-  description = "Public IP of the database instance"
-  value       = google_sql_database_instance.insecure_db.public_ip_address
+# FIXED: Removed database_public_ip output as DB no longer has public IP
+output "database_connection_name" {
+  description = "Connection name for the database instance (use with Cloud SQL Proxy)"
+  value       = google_sql_database_instance.insecure_db.connection_name
 }
 
 output "service_account_email" {
   description = "Email of the service account"
   value       = google_service_account.insecure_sa.email
+  sensitive   = true
 }
diff --git a/terraform/variables.tf b/terraform/variables.tf
index 4f2490b..3f481cc 100644
--- a/terraform/variables.tf
+++ b/terraform/variables.tf
@@ -1,4 +1,4 @@
-# INSECURE - Workshop demonstration only
+# SECURE - Workshop demonstration - secure version
 
 variable "project_id" {
   description = "GCP Project ID"
@@ -24,18 +24,22 @@ variable "machine_type" {
   default     = "e2-medium"
 }
 
-# VULN-7: Hardcoded password
+# FIXED: Password removed from code
 variable "db_password" {
-  description = "Database root password"
+  description = "Database root password (provide via GitHub Secrets or Secret Manager)"
   type        = string
-  default     = "admin123" # INSECURE
-  sensitive   = false      # INSECURE
+  sensitive   = true
+  # No default value - must be provided securely via:
+  # - GitHub Secrets in CI/CD
+  # - GCP Secret Manager for runtime
 }
 
-# VULN-8: Hardcoded API key
+# FIXED: API key removed from code
 variable "api_key" {
-  description = "API Key for external service"
+  description = "API Key for external service (provide via GitHub Secrets or Secret Manager)"
   type        = string
-  default     = "AIzaSyDXxxxxxxxxxxxxxxxxxxxxxxxxxx" # INSECURE
-  sensitive   = false                                # INSECURE
+  sensitive   = true
+  # No default value - must be provided securely via:
+  # - GitHub Secrets in CI/CD
+  # - GCP Secret Manager for runtime
 }
